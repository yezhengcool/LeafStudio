# 登录功能说明

## 🔐 管理员登录系统

已为 Web 管理后台添加完整的登录功能，包括登录验证和密码修改。

---

## 📋 功能清单

### 1. 登录页面
- ✅ 美观的登录界面
- ✅ 用户名和密码输入
- ✅ 密码显示/隐藏切换
- ✅ 登录状态保持
- ✅ 错误提示动画

### 2. 登录验证
- ✅ 静态验证（localStorage）
- ✅ 自动跳转
- ✅ Session 管理

### 3. 密码修改
- ✅ 当前密码验证
- ✅ 新密码长度检查（至少6位）
- ✅ 二次确认
- ✅ 安全提示

---

## 🔑 默认账户

### 初始登录信息

```
用户名: Leaf Studio
密码: Test123456
```

**重要提示**：首次登录后请立即修改密码！

---

## 📁 文件清单

### 新增文件
1. **`login.html`** - 登录页面

### 修改文件
1. **`index.html`** - 添加系统设置页面
2. **`script.js`** - 添加登录检查和密码修改功能
3. **`style.css`** - 添加设置页面样式

---

## 🚀 部署步骤

### 上传文件到服务器

将以下文件上传到 `https://yezheng.dpdns.org/tv/`：

```
tv/
├── login.html      ← 新增
├── index.html      ← 已更新
├── style.css       ← 已更新
└── script.js       ← 已更新
```

### 访问方式

- **登录页面**: `https://yezheng.dpdns.org/tv/login.html`
- **管理后台**: `https://yezheng.dpdns.org/tv/` (需要先登录)

---

## 💡 使用说明

### 首次登录

1. 访问 `https://yezheng.dpdns.org/tv/`
2. 自动跳转到登录页面
3. 输入默认账户：
   - 用户名：`Leaf Studio`
   - 密码：`Test123456`
4. 点击"登录"按钮
5. 登录成功后进入管理后台

### 修改密码

1. 登录后点击左侧菜单 **系统设置**
2. 找到"修改密码"部分
3. 输入当前密码
4. 输入新密码（至少6位）
5. 再次确认新密码
6. 点击"修改密码"按钮
7. 修改成功后，下次登录使用新密码

### 退出登录

1. 点击右上角的"退出"按钮
2. 确认退出
3. 自动跳转到登录页面

---

## 🔒 安全特性

### 1. 登录验证
- 用户名和密码必须完全匹配
- 登录失败会清空密码输入框
- 显示错误提示并震动动画

### 2. 密码保护
- 密码存储在 localStorage（浏览器本地）
- 密码输入框默认隐藏
- 支持显示/隐藏切换

### 3. Session 管理
- 登录状态保存在 localStorage
- 未登录自动跳转到登录页
- 退出登录清除所有状态

### 4. 密码修改
- 必须验证当前密码
- 新密码至少6位字符
- 二次确认防止输入错误

---

## 🎨 界面特点

### 登录页面
- 深色主题，与管理后台一致
- 渐变背景
- 毛玻璃效果
- 流畅的动画效果
- 响应式设计

### 系统设置页面
- 账户信息显示
- 登录时间记录
- 密码修改表单
- API 配置选项

---

## 📊 工作流程

### 登录流程

```
访问管理后台
    ↓
检查登录状态
    ↓
未登录？
    ├─ 是 → 跳转到登录页
    │        ↓
    │     输入账户密码
    │        ↓
    │     验证账户
    │        ↓
    │     登录成功
    │        ↓
    └─ 否 → 显示管理后台
```

### 密码修改流程

```
进入系统设置
    ↓
输入当前密码
    ↓
输入新密码（≥6位）
    ↓
确认新密码
    ↓
验证当前密码
    ├─ 正确 → 保存新密码
    │          ↓
    │       修改成功
    │          ↓
    │       清空输入框
    │
    └─ 错误 → 显示错误提示
```

---

## 🔧 技术实现

### 数据存储

使用 `localStorage` 存储以下信息：

```javascript
// 登录状态
localStorage.setItem('admin_logged_in', 'true');

// 用户名
localStorage.setItem('admin_username', 'Leaf Studio');

// 密码（加密存储建议）
localStorage.setItem('admin_password', 'Test123456');

// 登录时间
localStorage.setItem('login_time', new Date().toISOString());
```

### 登录检查

```javascript
function checkLogin() {
    const isLoggedIn = localStorage.getItem('admin_logged_in');
    if (isLoggedIn !== 'true') {
        window.location.href = 'login.html';
        return false;
    }
    return true;
}
```

### 密码验证

```javascript
// 验证当前密码
const storedPassword = localStorage.getItem('admin_password') || 'Test123456';
if (currentPassword !== storedPassword) {
    alert('当前密码错误');
    return;
}

// 保存新密码
localStorage.setItem('admin_password', newPassword);
```

---

## ⚠️ 注意事项

### 1. 密码安全

**当前实现**：
- 密码存储在浏览器 localStorage
- 适合单用户使用
- 适合内网环境

**生产环境建议**：
- 使用服务器端验证
- 密码加密存储
- 添加 HTTPS
- 实现 JWT Token
- 添加登录日志

### 2. 浏览器兼容性

- 需要支持 localStorage 的浏览器
- 清除浏览器数据会清除登录状态
- 不同浏览器的登录状态独立

### 3. 多设备登录

- 每个浏览器独立登录
- 修改密码后需要重新登录
- 建议定期修改密码

---

## 🎯 使用场景

### 场景 1：首次部署

1. 上传所有文件到服务器
2. 访问管理后台
3. 使用默认账户登录
4. 立即修改密码
5. 开始管理设备

### 场景 2：日常使用

1. 打开浏览器访问管理后台
2. 如果已登录，直接进入
3. 如果未登录，输入账户密码
4. 管理设备和激活码
5. 完成后可选择退出登录

### 场景 3：密码忘记

**解决方法**：

1. 打开浏览器开发者工具（F12）
2. 进入 Console 标签
3. 执行以下命令重置密码：

```javascript
localStorage.setItem('admin_password', 'Test123456');
alert('密码已重置为: Test123456');
```

4. 使用默认密码登录
5. 登录后立即修改密码

---

## 📝 常见问题

### Q1: 忘记密码怎么办？

**A**: 使用浏览器开发者工具重置密码（见上方"密码忘记"部分）

### Q2: 为什么每次打开都要登录？

**A**: 检查浏览器是否禁用了 localStorage，或者是否清除了浏览器数据

### Q3: 可以添加多个管理员吗？

**A**: 当前版本只支持单个管理员。如需多用户，需要改为服务器端验证

### Q4: 密码存储安全吗？

**A**: 当前存储在 localStorage，适合个人使用。生产环境建议使用服务器端验证

### Q5: 可以修改用户名吗？

**A**: 可以，在系统设置中修改，或通过开发者工具：
```javascript
localStorage.setItem('admin_username', '新用户名');
```

---

## ✅ 测试清单

部署后请测试以下功能：

- [ ] 访问管理后台自动跳转到登录页
- [ ] 使用默认账户可以成功登录
- [ ] 登录后显示用户名
- [ ] 登录后可以正常使用所有功能
- [ ] 退出登录后跳转到登录页
- [ ] 修改密码功能正常
- [ ] 使用新密码可以登录
- [ ] 密码错误时显示错误提示
- [ ] 刷新页面保持登录状态

---

## 🎉 总结

现在您的 Web 管理后台已经具备完整的登录功能：

- ✅ 美观的登录页面
- ✅ 安全的密码验证
- ✅ 便捷的密码修改
- ✅ 完善的 Session 管理

**默认账户**：
- 用户名：`Leaf Studio`
- 密码：`Test123456`

**首次登录后请立即修改密码！**

享受安全的管理体验！🔐
